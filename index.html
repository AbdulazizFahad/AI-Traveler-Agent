<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>🎲 Random Explorer Agent</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 15px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        }

        .header {
            text-align: center;
            margin-bottom: 25px;
        }

        .header h1 {
            font-size: 2.2em;
            color: #2c3e50;
            margin-bottom: 8px;
            font-weight: 700;
        }

        .header p {
            color: #7f8c8d;
            font-size: 1.1em;
            margin-bottom: 20px;
        }

        .explore-btn {
            background: linear-gradient(135deg, #ff6b6b, #ee5a24);
            color: white;
            border: none;
            padding: 15px 35px;
            border-radius: 50px;
            font-size: 1.2em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 8px 25px rgba(238, 90, 36, 0.3);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin-bottom: 25px;
        }

        .explore-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 35px rgba(238, 90, 36, 0.4);
        }

        .explore-btn:disabled {
            background: #bdc3c7;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .loading {
            display: none;
            align-items: center;
            justify-content: center;
            margin: 20px 0;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 400px;
            gap: 25px;
            margin-bottom: 20px;
        }

        .left-panel {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .map-container {
            width: 100%;
            height: 300px;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        #map {
            width: 100%;
            height: 100%;
            border-radius: 15px;
        }

        .city-info {
            display: none;
        }

        .city-header {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
            text-align: center;
        }

        .city-header h2 {
            font-size: 1.8em;
            margin-bottom: 8px;
            font-weight: 700;
        }

        .city-header p {
            opacity: 0.9;
            font-size: 1.1em;
            margin-bottom: 10px;
        }

        .coordinates {
            font-family: 'Courier New', monospace;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 0.9em;
            display: inline-block;
        }

        .compact-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .info-card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.08);
            border-left: 4px solid #667eea;
            transition: transform 0.3s ease;
        }

        .info-card:hover {
            transform: translateY(-3px);
        }

        .info-card h3 {
            color: #2c3e50;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 1.2em;
            font-weight: 600;
        }

        .stats-mini {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }

        .stat-item {
            background: linear-gradient(135deg, #fd79a8, #e84393);
            color: white;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            transition: transform 0.3s ease;
        }

        .stat-item:hover {
            transform: scale(1.05);
        }

        .stat-number {
            font-size: 1.3em;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 0.85em;
            opacity: 0.9;
        }

        .fact-item {
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            padding: 12px;
            border-radius: 10px;
            margin-bottom: 10px;
            border-left: 3px solid #667eea;
            font-size: 0.95em;
            transition: transform 0.2s ease;
        }

        .fact-item:hover {
            transform: translateX(3px);
        }

        .weather-mini {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
        }

        .weather-item {
            background: linear-gradient(135deg, #74b9ff, #0984e3);
            color: white;
            padding: 12px;
            border-radius: 10px;
            text-align: center;
            transition: transform 0.3s ease;
        }

        .weather-item:hover {
            transform: translateY(-2px);
        }

        .weather-item h4 {
            font-size: 0.8em;
            opacity: 0.8;
            margin-bottom: 5px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .weather-item p {
            font-size: 1.2em;
            font-weight: 700;
        }

        /* Chat Panel Styles */
        .chat-panel {
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            display: flex;
            flex-direction: column;
            height: 600px;
            overflow: hidden;
            border: 1px solid rgba(0, 0, 0, 0.1);
        }

        .chat-header {
            background: linear-gradient(135deg, #a29bfe, #6c5ce7);
            color: white;
            padding: 15px 20px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.1em;
        }

        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            background: #fafafa;
        }

        .message {
            margin-bottom: 15px;
            max-width: 85%;
            animation: fadeIn 0.3s ease;
        }

        .message.user {
            margin-left: auto;
        }

        .message.ai {
            margin-right: auto;
        }

        .message-content {
            padding: 12px 16px;
            border-radius: 18px;
            font-size: 0.95em;
            line-height: 1.4;
        }

        .message.user .message-content {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border-bottom-right-radius: 6px;
        }

        .message.ai .message-content {
            background: white;
            color: #2c3e50;
            border: 1px solid #e0e0e0;
            border-bottom-left-radius: 6px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }

        .chat-input-container {
            padding: 15px 20px;
            background: white;
            border-top: 1px solid #e0e0e0;
            display: flex;
            gap: 10px;
        }

        .chat-input {
            flex: 1;
            border: 1px solid #ddd;
            border-radius: 25px;
            padding: 10px 16px;
            font-size: 0.95em;
            outline: none;
            transition: border-color 0.3s ease;
        }

        .chat-input:focus {
            border-color: #667eea;
        }

        .send-btn {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            font-size: 1.1em;
        }

        .send-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        .send-btn:disabled {
            background: #bdc3c7;
            cursor: not-allowed;
            transform: none;
        }

        .typing-indicator {
            display: none;
            padding: 12px 16px;
            background: white;
            border: 1px solid #e0e0e0;
            border-radius: 18px;
            border-bottom-left-radius: 6px;
            margin-bottom: 15px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
            max-width: 85%;
        }

        .typing-dots {
            display: flex;
            gap: 4px;
        }

        .typing-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #bbb;
            animation: typingAnimation 1.4s infinite;
        }

        .typing-dot:nth-child(2) {
            animation-delay: 0.2s;
        }

        .typing-dot:nth-child(3) {
            animation-delay: 0.4s;
        }

        @keyframes typingAnimation {
            0%, 60%, 100% {
                transform: translateY(0);
                opacity: 0.5;
            }
            30% {
                transform: translateY(-10px);
                opacity: 1;
            }
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .suggestions-row {
            background: linear-gradient(135deg, #00b894, #00a085);
            color: white;
            padding: 20px;
            border-radius: 15px;
            margin-top: 20px;
        }

        .suggestions-row h3 {
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.3em;
            color: white;
        }

        .suggestion-items {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
        }

        .suggestion-item {
            background: rgba(255, 255, 255, 0.2);
            padding: 12px;
            border-radius: 10px;
            font-size: 0.95em;
            transition: transform 0.2s ease;
        }

        .suggestion-item:hover {
            transform: translateX(3px);
        }

        .error-message {
            background: #ff7675;
            color: white;
            padding: 15px;
            border-radius: 10px;
            margin: 20px 0;
            text-align: center;
            display: none;
            font-size: 1em;
        }

        /* Custom scrollbar */
        .chat-messages::-webkit-scrollbar {
            width: 6px;
        }

        .chat-messages::-webkit-scrollbar-track {
            background: #f1f1f1;
        }

        .chat-messages::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 3px;
        }

        .chat-messages::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8;
        }

        /* Responsive design */
        @media (max-width: 1024px) {
            .main-content {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            
            .chat-panel {
                height: 500px;
            }
            
            .compact-grid {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            
            .container {
                padding: 20px;
            }
            
            .header h1 {
                font-size: 1.8em;
            }
            
            .stats-mini,
            .weather-mini {
                grid-template-columns: 1fr;
            }
            
            .suggestion-items {
                grid-template-columns: 1fr;
            }
            
            .map-container {
                height: 250px;
            }
            
            .chat-panel {
                height: 400px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🎲 Random AI-Agent Explorer</h1>
            <p>Discover amazing places and chat with AI about them!</p>
            <button class="explore-btn" id="exploreBtn">
                <span>Take me somewhere random!</span>
                <span>🌍</span>
            </button>
        </div>

        <div class="loading" id="loading">
            <div class="spinner"></div>
            <p style="margin-left: 15px; color: #667eea; font-size: 1.1em;">Finding your adventure...</p>
        </div>

        <div class="error-message" id="errorMessage"></div>

        <div class="main-content">
            <div class="left-panel">
                <div class="map-container">
                    <div id="map"></div>
                </div>

                <div class="city-info" id="cityInfo">
                    <div class="city-header" id="cityHeader">
                        <h2 id="cityName"></h2>
                        <p id="countryName"></p>
                        <div class="coordinates" id="coordinates"></div>
                    </div>

                    <div class="compact-grid">
                        <div class="info-card">
                            <h3>📊 Quick Stats</h3>
                            <div class="stats-mini" id="statsGrid">
                                <div class="stat-item">
                                    <div class="stat-number" id="timezone">UTC+2</div>
                                    <div class="stat-label">Time Zone</div>
                                </div>
                                <div class="stat-item">
                                    <div class="stat-number" id="population">2.4M</div>
                                    <div class="stat-label">Population</div>
                                </div>
                                <div class="stat-item">
                                    <div class="stat-number" id="elevation">1,086m</div>
                                    <div class="stat-label">Elevation</div>
                                </div>
                                <div class="stat-item">
                                    <div class="stat-number" id="founded">1652</div>
                                    <div class="stat-label">Founded</div>
                                </div>
                            </div>
                        </div>

                        <div class="info-card">
                            <h3>🌟 Quick Facts</h3>
                            <div id="factsContainer"></div>
                        </div>

                        <div class="info-card">
                            <h3>🌤️ Current Weather</h3>
                            <div class="weather-mini" id="weatherInfo"></div>
                        </div>
                    </div>

                    <div class="suggestions-row">
                        <h3>✈️ Travel Suggestions</h3>
                        <div class="suggestion-items" id="routeInfo"></div>
                    </div>
                </div>
            </div>

            <div class="chat-panel">
                <div class="chat-header">
                    <span>🤖</span>
                    <span>AI Travel Assistant</span>
                </div>
                <div class="chat-messages" id="chatMessages">
                    <div class="message ai">
                        <div class="message-content">
                            👋 Hi! I'm your AI travel assistant. Once you explore a random city, I'll have all the knowledge about that destination and can answer any questions you have about it. Try clicking the explore button above!
                        </div>
                    </div>
                </div>
                <div class="typing-indicator" id="typingIndicator">
                    <div class="typing-dots">
                        <div class="typing-dot"></div>
                        <div class="typing-dot"></div>
                        <div class="typing-dot"></div>
                    </div>
                </div>
                <div class="chat-input-container">
                    <input type="text" class="chat-input" id="chatInput" placeholder="Ask me anything about the current city..." disabled>
                    <button class="send-btn" id="sendBtn" disabled>
                        <span>→</span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        // Configuration
        const GEMINI_API_KEY = "AIzaSyAUoMONS3OL3z0iMKWj2AV0ntg7wSQuSTs";
        
        let currentCity = null;
        let chatHistory = [];
        
        // Random cities database
        const cities = [
            {
                name: "Reykjavik",
                country: "Iceland",
                lat: 64.1466,
                lng: -21.9426,
                flag: "🇮🇸",
                facts: ["Northern Lights capital", "Geothermal energy city", "No mosquitoes exist here"],
                timezone: "UTC+0",
                population: "131K",
                elevation: "61m",
                founded: "874"
            },
            {
                name: "Kyoto",
                country: "Japan", 
                lat: 35.0116,
                lng: 135.7681,
                flag: "🇯🇵",
                facts: ["Former imperial capital", "Over 2000 temples", "Bamboo forest trails"],
                timezone: "UTC+9",
                population: "1.5M",
                elevation: "56m",
                founded: "794"
            },
            {
                name: "Cape Town",
                country: "South Africa",
                lat: -33.9249,
                lng: 18.4241,
                flag: "🇿🇦",
                facts: ["Two ocean confluence", "Table Mountain views", "Penguin colonies nearby"],
                timezone: "UTC+2",
                population: "4.6M",
                elevation: "25m",
                founded: "1652"
            },
            {
                name: "Bergen",
                country: "Norway",
                lat: 60.3913,
                lng: 5.3221,
                flag: "🇳🇴",
                facts: ["Gateway to fjords", "Colorful wooden houses", "Rainiest city in Europe"],
                timezone: "UTC+1",
                population: "285K",
                elevation: "56m",
                founded: "1070"
            },
            {
                name: "Cusco",
                country: "Peru",
                lat: -13.5319,
                lng: -71.9675,
                flag: "🇵🇪",
                facts: ["Ancient Inca capital", "Gateway to Machu Picchu", "11,200 feet altitude"],
                timezone: "UTC-5",
                population: "428K",
                elevation: "3,399m",
                founded: "1100"
            },
            {
                name: "Tallinn",
                country: "Estonia",
                lat: 59.4370,
                lng: 24.7536,
                flag: "🇪🇪",
                facts: ["Medieval old town", "Digital nomad paradise", "Most startups per capita"],
                timezone: "UTC+2",
                population: "437K",
                elevation: "9m",
                founded: "1248"
            },
            {
                name: "Marrakech",
                country: "Morocco",
                lat: 31.6295,
                lng: -7.9811,
                flag: "🇲🇦",
                facts: ["Red city walls", "Bustling souks", "Atlas Mountains gateway"],
                timezone: "UTC+1",
                population: "928K",
                elevation: "466m",
                founded: "1062"
            },
            {
                name: "Chiang Mai",
                country: "Thailand",
                lat: 18.7883,
                lng: 98.9853,
                flag: "🇹🇭",
                facts: ["Rose of the North", "300+ temples", "Digital nomad hub"],
                timezone: "UTC+7",
                population: "131K",
                elevation: "316m",
                founded: "1296"
            }
        ];

        // Initialize map
        let map;
        let currentMarker;

        function initMap() {
            map = L.map('map').setView([20, 0], 2);
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '© OpenStreetMap contributors'
            }).addTo(map);
        }

        // Chat functionality
        async function sendMessage() {
            const input = document.getElementById('chatInput');
            const message = input.value.trim();
            
            if (!message || !currentCity) return;
            
            // Add user message
            addMessage(message, 'user');
            input.value = '';
            
            // Show typing indicator
            showTyping();
            
            try {
                // Create context-aware prompt
                const contextPrompt = `You are a knowledgeable travel assistant with expertise about ${currentCity.name}, ${currentCity.country}. Here's what you know about this destination:

City: ${currentCity.name}
Country: ${currentCity.country}
Location: ${currentCity.lat}°, ${currentCity.lng}°
Key Facts: ${currentCity.facts.join(', ')}
Population: ${currentCity.population}
Timezone: ${currentCity.timezone}
Elevation: ${currentCity.elevation}
Founded: ${currentCity.founded}

User question: ${message}

Provide a helpful, informative response about ${currentCity.name}, ${currentCity.country}. Be specific, engaging, and include practical travel advice when relevant. Keep responses conversational but informative (2-3 paragraphs max).`;

                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent?key=${GEMINI_API_KEY}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        contents: [{
                            parts: [{
                                text: contextPrompt
                            }]
                        }]
                    })
                });

                if (!response.ok) {
                    throw new Error('API error');
                }

                const data = await response.json();
                const aiResponse = data.candidates[0].content.parts[0].text;
                
                hideTyping();
                addMessage(aiResponse, 'ai');
                
            } catch (error) {
                console.error('Chat error:', error);
                hideTyping();
                addMessage("I'm sorry, I'm having trouble connecting right now. Please try again later!", 'ai');
            }
        }

        function addMessage(content, sender) {
            const messagesContainer = document.getElementById('chatMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${sender}`;
            
            const contentDiv = document.createElement('div');
            contentDiv.className = 'message-content';
            contentDiv.textContent = content;
            
            messageDiv.appendChild(contentDiv);
            messagesContainer.appendChild(messageDiv);
            
            // Scroll to bottom
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        function showTyping() {
            document.getElementById('typingIndicator').style.display = 'block';
            const messagesContainer = document.getElementById('chatMessages');
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        function hideTyping() {
            document.getElementById('typingIndicator').style.display = 'none';
        }

        // Generate mock weather data
        function generateWeatherData() {
            const temperatures = [15, 18, 22, 25, 28, 12, 8, 30];
            const conditions = ["Sunny", "Cloudy", "Rainy", "Clear"];
            const humidity = [45, 55, 70, 60, 40, 80];
            
            return {
                temperature: temperatures[Math.floor(Math.random() * temperatures.length)],
                condition: conditions[Math.floor(Math.random() * conditions.length)],
                humidity: humidity[Math.floor(Math.random() * humidity.length)],
                windSpeed: Math.floor(Math.random() * 20) + 5
            };
        }

        // Generate AI content
        async function generateCityContent(city, country) {
            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent?key=${GEMINI_API_KEY}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        contents: [{
                            parts: [{
                                text: `Generate 3 interesting travel facts about ${city}, ${country} and 3 specific travel suggestions (best time to visit, must-see attraction, local food). Keep each item under 50 characters. Format as: FACTS: fact1|fact2|fact3 SUGGESTIONS: sug1|sug2|sug3`
                            }]
                        }]
                    })
                });

                if (!response.ok) throw new Error('API error');

                const data = await response.json();
                const text = data.candidates[0].content.parts[0].text;
                
                const facts = text.match(/FACTS:\s*(.+?)(?=SUGGESTIONS:|$)/)?.[1]?.split('|') || 
                    ["Rich cultural heritage", "Unique architecture", "Local traditions"];
                const suggestions = text.match(/SUGGESTIONS:\s*(.+)/)?.[1]?.split('|') || 
                    ["Visit in spring/fall", "Explore historic center", "Try local specialties"];
                
                return { facts: facts.slice(0, 3), suggestions: suggestions.slice(0, 3) };
            } catch (error) {
                console.error('Error generating content:', error);
                return {
                    facts: ["Rich cultural heritage", "Unique local cuisine", "Beautiful architecture"],
                    suggestions: ["Best time: Spring/Fall", "Must-see: City center", "Try: Local dishes"]
                };
            }
        }

        // Main exploration function
        async function exploreRandomCity() {
            const exploreBtn = document.getElementById('exploreBtn');
            const loading = document.getElementById('loading');
            const cityInfo = document.getElementById('cityInfo');
            const errorMessage = document.getElementById('errorMessage');
            const chatInput = document.getElementById('chatInput');
            const sendBtn = document.getElementById('sendBtn');

            try {
                // Show loading state
                exploreBtn.disabled = true;
                loading.style.display = 'flex';
                cityInfo.style.display = 'none';
                errorMessage.style.display = 'none';

                // Select random city
                const randomCity = cities[Math.floor(Math.random() * cities.length)];
                currentCity = randomCity;
                
                // Update map
                if (currentMarker) {
                    map.removeLayer(currentMarker);
                }

                currentMarker = L.marker([randomCity.lat, randomCity.lng])
                    .addTo(map)
                    .bindPopup(`<b>${randomCity.name}</b><br>${randomCity.country}`)
                    .openPopup();

                map.setView([randomCity.lat, randomCity.lng], 10);

                // Update city header
                document.getElementById('cityName').textContent = randomCity.name;
                document.getElementById('countryName').textContent = `${randomCity.flag} ${randomCity.country}`;
                document.getElementById('coordinates').textContent = 
                    `${randomCity.lat.toFixed(4)}°, ${randomCity.lng.toFixed(4)}°`;

                // Update stats
                document.getElementById('timezone').textContent = randomCity.timezone;
                document.getElementById('population').textContent = randomCity.population;
                document.getElementById('elevation').textContent = randomCity.elevation;
                document.getElementById('founded').textContent = randomCity.founded;

                // Generate AI content
                const aiContent = await generateCityContent(randomCity.name, randomCity.country);
                
                // Update current city facts
                currentCity.facts = aiContent.facts;

                // Update facts
                const factsContainer = document.getElementById('factsContainer');
                factsContainer.innerHTML = aiContent.facts.map(fact => 
                    `<div class="fact-item">💡 ${fact}</div>`
                ).join('');

                // Update weather
                const weather = generateWeatherData();
                const weatherInfo = document.getElementById('weatherInfo');
                weatherInfo.innerHTML = `
                    <div class="weather-item">
                        <h4>Temperature</h4>
                        <p>${weather.temperature}°C</p>
                    </div>
                    <div class="weather-item">
                        <h4>Condition</h4>
                        <p>${weather.condition}</p>
                    </div>
                    <div class="weather-item">
                        <h4>Humidity</h4>
                        <p>${weather.humidity}%</p>
                    </div>
                    <div class="weather-item">
                        <h4>Wind Speed</h4>
                        <p>${weather.windSpeed} km/h</p>
                    </div>
                `;

                // Update travel suggestions
                const routeInfo = document.getElementById('routeInfo');
                routeInfo.innerHTML = aiContent.suggestions.map(suggestion => 
                    `<div class="suggestion-item">✨ ${suggestion}</div>`
                ).join('');

                // Enable chat
                chatInput.disabled = false;
                sendBtn.disabled = false;
                chatInput.placeholder = `Ask me anything about ${randomCity.name}...`;

                // Add AI welcome message for the new city
                addMessage(`🌟 I now have detailed knowledge about ${randomCity.name}, ${randomCity.country}! Ask me anything about attractions, food, culture, weather, travel tips, or anything else you'd like to know about this destination.`, 'ai');

                // Show city info with animation
                setTimeout(() => {
                    cityInfo.style.display = 'block';
                }, 500);

            } catch (error) {
                console.error('Error exploring city:', error);
                errorMessage.textContent = 'Failed to load city information. Please try again!';
                errorMessage.style.display = 'block';
            } finally {
                loading.style.display = 'none';
                exploreBtn.disabled = false;
            }
        }

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            initMap();
            
            document.getElementById('exploreBtn').addEventListener('click', exploreRandomCity);
            
            // Chat event listeners
            document.getElementById('sendBtn').addEventListener('click', sendMessage);
            document.getElementById('chatInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    sendMessage();
                }
            });
        });
    </script>
</body>
</html>